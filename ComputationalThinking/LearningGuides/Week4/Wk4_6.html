<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>L4.6: Birthday Paradox with Procedures</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* slate-50 */
        }
        .sidebar-link.active {
            background-color: #e0f2fe; /* sky-100 */
            color: #0c4a6e; /* sky-900 */
            font-weight: 600;
        }
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f5f9; /* slate-100 */
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1; /* slate-300 */
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8; /* slate-400 */
        }
        .quiz-option.correct {
            background-color: #dcfce7; /* green-100 */
            border-color: #22c55e; /* green-500 */
        }
        .quiz-option.incorrect {
            background-color: #fee2e2; /* red-100 */
            border-color: #ef4444; /* red-500 */
        }
        .feedback {
            display: none;
            padding: 0.75rem;
            margin-top: 0.75rem;
            border-radius: 0.5rem;
        }
        .feedback.correct {
            display: block;
            background-color: #f0fdf4; /* green-50 */
            color: #15803d; /* green-800 */
        }
        .feedback.incorrect {
            display: block;
            background-color: #fef2f2; /* red-50 */
            color: #b91c1c; /* red-800 */
        }
        .code-block {
            background-color: #0f172a; /* slate-900 */
            color: #e2e8f0; /* slate-200 */
            padding: 1rem;
            border-radius: 0.5rem;
            font-family: monospace;
            white-space: pre-wrap;
        }
        .code-keyword { color: #7dd3fc; } /* sky-300 */
        .code-variable { color: #f8fafc; } /* slate-50 */
        .code-value { color: #fcd34d; } /* amber-300 */
        .code-comment { color: #94a3b8; } /* slate-400 */
        .code-proc { color: #a5b4fc; } /* indigo-300 */
        .person-card {
            transition: all 0.2s ease-in-out;
        }
        .person-card.active-outer {
             border-color: #3b82f6; /* blue-500 */
             transform: scale(1.1);
             box-shadow: 0 0 15px rgba(59, 130, 246, 0.5);
             z-index: 10;
        }
        .person-card.active-inner {
            border-color: #a855f7; /* purple-500 */
            transform: scale(1.1);
        }
        .person-card.match {
            border-color: #22c55e; /* green-500 */
            background-color: #dcfce7; /* green-100 */
        }
    </style>
</head>
<body class="text-slate-800">

    <!-- Mobile Header with Hamburger Menu -->
    <header class="bg-white/80 backdrop-blur-lg shadow-sm sticky top-0 z-40 lg:hidden flex items-center justify-between p-4">
        <h1 class="text-lg font-bold text-sky-800">Learning Guide</h1>
        <button id="hamburger-btn" class="p-2 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
        </button>
    </header>

    <div class="flex">
        <!-- Sidebar Navigation -->
        <aside id="sidebar" class="bg-white w-64 fixed inset-y-0 left-0 transform -translate-x-full lg:translate-x-0 lg:sticky lg:top-0 h-screen transition-transform duration-300 ease-in-out z-50 shadow-lg lg:shadow-none border-r border-slate-200">
            <div class="p-6">
                <h2 class="text-xl font-bold text-sky-800 mb-6">L4.6: Birthday Paradox Procedure</h2>
                <nav>
                    <ul id="nav-links" class="space-y-2">
                        <li><a href="#intro" class="sidebar-link block px-4 py-2 rounded-md text-slate-600 hover:bg-sky-50 transition-colors">Introduction</a></li>
                        <li><a href="#problem" class="sidebar-link block px-4 py-2 rounded-md text-slate-600 hover:bg-sky-50 transition-colors">Simplifying Nested Loops</a></li>
                        <li><a href="#solution" class="sidebar-link block px-4 py-2 rounded-md text-slate-600 hover:bg-sky-50 transition-colors">The `sameBirthday` Procedure</a></li>
                        <li><a href="#main-algo" class="sidebar-link block px-4 py-2 rounded-md text-slate-600 hover:bg-sky-50 transition-colors">The Main Algorithm</a></li>
                        <li><a href="#interactive-sim" class="sidebar-link block px-4 py-2 rounded-md text-slate-600 hover:bg-sky-50 transition-colors">Interactive Simulator</a></li>
                        <li><a href="#quiz" class="sidebar-link block px-4 py-2 rounded-md text-slate-600 hover:bg-sky-50 transition-colors">Knowledge Check</a></li>
                    </ul>
                </nav>
            </aside>

        <!-- Main Content -->
        <main id="main-content" class="flex-1 p-6 md:p-10 lg:p-12 bg-slate-50 min-h-screen lg:h-screen lg:overflow-y-auto">
            <div class="max-w-4xl mx-auto">

                <!-- Introduction Section -->
                <section id="intro" class="mb-12">
                    <h2 class="text-3xl font-bold text-sky-900 mb-4 border-b-2 border-sky-200 pb-2">Modularizing Our Logic</h2>
                    <p class="text-lg text-slate-700 mb-4">
                        We've established that a nested loop is a valid way to solve the birthday paradox problem. However, writing nested loops can sometimes make the main algorithm look complex and hard to read.
                    </p>
                    <p class="text-lg text-slate-700">
                        A cleaner approach is to encapsulate the logic of the "inner loop" into its own dedicated procedure. This makes our main algorithm simpler and highlights the overall strategy more clearly.
                    </p>
                </section>

                <!-- Simplifying Nested Loops Section -->
                <section id="problem" class="mb-12">
                    <h2 class="text-3xl font-bold text-sky-900 mb-4 border-b-2 border-sky-200 pb-2">Simplifying the Nested Loop</h2>
                    <p class="text-lg text-slate-700 mb-4">
                        Let's revisit the logic. The outer loop picks a card, `X`. The inner loop then compares `X` to all subsequent cards in the pile. We can think of the inner loop's job as a single question: "Does card `X` have the same birthday as anyone else in the rest of the pile?"
                    </p>
                    <p class="text-lg text-slate-700">
                        This question can be answered by a helper procedure. By creating this helper, we can transform our complex nested loop into a simple, single loop that calls this procedure.
                    </p>
                </section>

                <!-- The `sameBirthday` Procedure Section -->
                <section id="solution" class="mb-12">
                    <h2 class="text-3xl font-bold text-sky-900 mb-4 border-b-2 border-sky-200 pb-2">The `sameBirthday` Procedure</h2>
                    <p class="text-lg text-slate-700 mb-4">
                        We can define a procedure, `sameBirthday(X, P)`, that takes two parameters: a single card `X` and a pile of cards `P`. Its job is to iterate through pile `P` and check if any card in it has the same birthday as card `X`.
                    </p>
                    <div class="code-block">
<span class="code-keyword">Procedure</span> <span class="code-proc">sameBirthday</span>(<span class="code-variable">CardX</span>, <span class="code-variable">PileP</span>) {
  <span class="code-keyword">while</span> (PileP has more cards) {
    Pick a card Y from PileP
    <span class="code-keyword">if</span> (<span class="code-variable">CardX.DateOfBirth</span> == <span class="code-variable">Y.DateOfBirth</span>) {
      <span class="code-keyword">return</span>(<span class="code-value">True</span>)  <span class="code-comment">// Match found!</span>
    }
  }
  <span class="code-keyword">return</span>(<span class="code-value">False</span>) <span class="code-comment">// No match found in the whole pile</span>
}
                    </div>
                    <p class="text-lg text-slate-700 mt-4">
                        This procedure neatly contains the logic of the inner loop. It stops and returns `True` as soon as it finds a match, or finishes the whole pile and returns `False`.
                    </p>
                </section>
                
                <!-- The Main Algorithm Section -->
                <section id="main-algo" class="mb-12">
                    <h2 class="text-3xl font-bold text-sky-900 mb-4 border-b-2 border-sky-200 pb-2">The Main Algorithm (Simplified)</h2>
                    <p class="text-lg text-slate-700 mb-4">
                        With our helper procedure, the main algorithm becomes much cleaner. It's now a single loop that uses our `found` flag for conditional termination.
                    </p>
                    <div class="code-block">
<span class="code-variable">found</span> = <span class="code-value">False</span>

<span class="code-keyword">while</span> (More cards in Pile-1 <span class="code-keyword">and</span> found == <span class="code-value">False</span>) {
  Pick a card X from Pile-1
  Move X to Pile-2

  <span class="code-keyword">if</span> (<span class="code-proc">sameBirthday</span>(X, Pile-1)) {
    <span class="code-variable">found</span> = <span class="code-value">True</span>
  }
}
                    </div>
                     <p class="text-lg text-slate-700 mt-4">
                        Here, we iterate through Pile-1. For each card `X` we pick, we call `sameBirthday` to compare it against the rest of the cards still in Pile-1. If it finds a match, `found` becomes `True`, and the main loop stops on its next check.
                    </p>
                </section>

                <!-- Interactive Simulator Section -->
                <section id="interactive-sim" class="mb-12">
                    <h2 class="text-3xl font-bold text-sky-900 mb-4 border-b-2 border-sky-200 pb-2">⚙️ Procedure-Based Simulator</h2>
                    <p class="text-lg text-slate-700 mb-6">
                        This simulator demonstrates the algorithm using the `sameBirthday` procedure. The outer loop will process one card at a time from the "Unseen" pile. For each card, the inner loop (our procedure) will compare it against all cards in the "Seen" pile.
                    </p>
                    <div class="bg-white p-6 rounded-xl shadow-md">
                        <div class="flex justify-center space-x-4 mb-4">
                            <button id="start-sim-btn" class="px-6 py-2 bg-sky-600 text-white font-semibold rounded-lg shadow-md hover:bg-sky-700">Find Match</button>
                            <button id="reset-sim-btn" class="px-6 py-2 bg-slate-500 text-white font-semibold rounded-lg shadow-md hover:bg-slate-600">Reset</button>
                        </div>
                        <div id="sim-status" class="text-center font-semibold text-lg h-8 mb-4 text-slate-700">Press 'Find Match' to start.</div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <h4 class="font-bold text-center mb-2">Unseen Pile</h4>
                                <div id="unseen-pile" class="min-h-[100px] p-2 bg-slate-100 rounded-lg flex flex-wrap gap-2 justify-center"></div>
                            </div>
                            <div>
                                <h4 class="font-bold text-center mb-2">Seen Pile</h4>
                                <div id="seen-pile" class="min-h-[100px] p-2 bg-slate-100 rounded-lg flex flex-wrap gap-2 justify-center"></div>
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- Quiz Section -->
                <section id="quiz">
                    <h2 class="text-3xl font-bold text-sky-900 mb-4 border-b-2 border-sky-200 pb-2">🧠 Knowledge Check</h2>
                    <p class="text-lg text-slate-700 mb-8">
                        Test your understanding of using procedures to solve the birthday problem.
                    </p>
                    <div id="quiz-container" class="space-y-8"></div>
                </section>

            </div>
        </main>
    </div>

    <script>
        // --- Sidebar and Scroll Logic ---
        const hamburgerBtn = document.getElementById('hamburger-btn');
        const sidebar = document.getElementById('sidebar');
        const mainContent = document.getElementById('main-content');
        const navLinks = document.getElementById('nav-links');

        hamburgerBtn.addEventListener('click', () => sidebar.classList.toggle('-translate-x-full'));
        navLinks.addEventListener('click', (e) => {
            if (e.target.tagName === 'A' && window.innerWidth < 1024) {
                sidebar.classList.add('-translate-x-full');
            }
        });
        
        const sections = document.querySelectorAll('section');
        const links = document.querySelectorAll('.sidebar-link');
        mainContent.addEventListener('scroll', () => {
            let current = '';
            sections.forEach(section => {
                if (mainContent.scrollTop >= section.offsetTop - 100) {
                    current = section.getAttribute('id');
                }
            });
            links.forEach(link => {
                link.classList.toggle('active', link.getAttribute('href') === `#${current}`);
            });
        });

        // --- Interactive Simulator Logic ---
        const startSimBtn = document.getElementById('start-sim-btn');
        const resetSimBtn = document.getElementById('reset-sim-btn');
        const simStatus = document.getElementById('sim-status');
        const unseenPileEl = document.getElementById('unseen-pile');
        const seenPileEl = document.getElementById('seen-pile');
        
        let unseenPile = [];
        let seenPile = [];
        const MONTHS = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"];

        function createPerson(id) {
            const day = Math.floor(Math.random() * 28) + 1;
            const month = MONTHS[Math.floor(Math.random() * 12)];
            return { id: id, birthday: `${day}-${month}` };
        }
        
        function setupPiles() {
            unseenPile = Array.from({length: 12}, (_, i) => createPerson(i));
            // Ensure a match exists for demonstration
            const matchIndex = Math.floor(Math.random() * 10) + 1;
            const targetIndex = Math.floor(Math.random() * matchIndex);
            unseenPile[matchIndex].birthday = unseenPile[targetIndex].birthday;
            seenPile = [];
        }

        function renderPiles() {
            unseenPileEl.innerHTML = unseenPile.map(p => `<div id="person-${p.id}" class="person-card p-1 text-xs rounded bg-white shadow border-2 border-transparent">${p.birthday}</div>`).join('');
            seenPileEl.innerHTML = seenPile.map(p => `<div id="person-${p.id}" class="person-card p-1 text-xs rounded bg-white shadow border-2 border-transparent">${p.birthday}</div>`).join('');
        }

        function resetSimulator() {
            setupPiles();
            renderPiles();
            simStatus.textContent = "Press 'Find Match' to start.";
            simStatus.classList.remove('text-green-700');
            startSimBtn.disabled = false;
        }

        async function runSimulation() {
            startSimBtn.disabled = true;
            let found = false;
            
            // This is the main loop
            while (unseenPile.length > 0 && !found) {
                const cardX = unseenPile.shift();
                seenPile.push(cardX);
                renderPiles();
                const cardXEl = document.getElementById(`person-${cardX.id}`);
                cardXEl.classList.add('active-outer');
                simStatus.textContent = `Picking ${cardX.birthday} to check...`;
                await new Promise(r => setTimeout(r, 500));
                
                // This simulates the sameBirthday(cardX, unseenPile) procedure call
                simStatus.textContent = `Calling sameBirthday(${cardX.birthday}, Unseen Pile)...`;

                for (const cardY of unseenPile) {
                    const cardYEl = document.getElementById(`person-${cardY.id}`);
                    cardYEl.classList.add('active-inner');
                    await new Promise(r => setTimeout(r, 250));

                    if (cardX.birthday === cardY.birthday) {
                        found = true;
                        simStatus.textContent = `Match found! ${cardX.birthday}`;
                        simStatus.classList.add('text-green-700');
                        cardXEl.classList.add('match');
                        cardYEl.classList.add('match');
                        break; 
                    }
                    cardYEl.classList.remove('active-inner');
                }
                
                cardXEl.classList.remove('active-outer');
                if (found) break;
            }
            
            if (!found) {
                 simStatus.textContent = "No match found after all comparisons.";
            }
        }

        startSimBtn.addEventListener('click', runSimulation);
        resetSimBtn.addEventListener('click', resetSimulator);
        resetSimulator();
        
        // --- Quiz Logic ---
        const quizContainer = document.getElementById('quiz-container');
        const quizData = [
            { question: "Are the two code-blocks shown equivalent?", code: `<div class="grid grid-cols-1 md:grid-cols-2 gap-4"><div class="code-block"><span class="code-comment">Code-block 1</span><br><span class="code-keyword">if</span>(X.DateOfBirth == Y.DateOfBirth){<br>  <span class="code-keyword">return</span>(True)<br>}<br><span class="code-keyword">else</span>{<br>  <span class="code-keyword">return</span>(False)<br>}</div><div class="code-block"><span class="code-comment">Code-block 2</span><br><span class="code-keyword">if</span>(X.DateOfBirth != Y.DateOfBirth){<br>  <span class="code-keyword">return</span>(False)<br>}<br><span class="code-keyword">else</span>{<br>  <span class="code-keyword">return</span>(True)<br>}</div></div>`, options: ["Yes", "No"], correct: ["Yes"], type: "single", explanation: "Yes. Code-block 2 checks for the opposite condition (`!=`) and returns the opposite boolean values. This is logically equivalent to Code-block 1." },
            { question: "In the provided pseudocode for finding a birthday match, what is the ideal choice for Statement-1?", code: `<div class="code-block">*** Statement-1 ***<br><span class="code-keyword">while</span>(More cards in Pile-1 <span class="code-keyword">and</span> found == False){<br>  Pick a card X from Pile-1<br>  Move X to Pile-2<br>  <span class="code-keyword">if</span>(<span class="code-proc">sameBirthday</span>(X, Pile-1)){<br>    *** Statement-2 ***<br>  }<br>}</div>`, options: ["found = False", "found = True", "found = None"], correct: ["found = False"], type: "single", explanation: "Statement-1 is the initialization step before the loop. The `found` flag must be initialized to `False` to indicate that a match has not yet been found." },
            { question: "In the same pseudocode, what is the ideal choice for Statement-2?", code: `<div class="code-block">*** Statement-1 ***<br><span class="code-keyword">while</span>(More cards in Pile-1 <span class="code-keyword">and</span> found == False){<br>  Pick a card X from Pile-1<br>  Move X to Pile-2<br>  <span class="code-keyword">if</span>(<span class="code-proc">sameBirthday</span>(X, Pile-1)){<br>    *** Statement-2 ***<br>  }<br>}</div>`, options: ["found = False", "found = True", "found = None"], correct: ["found = True"], type: "single", explanation: "Statement-2 is executed only when the `sameBirthday` procedure returns true (a match is found). At this point, we must update the `found` flag to `True` to terminate the `while` loop." },
            { question: "What is the main benefit of encapsulating the inner loop's logic into a `sameBirthday` procedure?", options: ["It makes the program run faster.", "It reduces the number of comparisons.", "It makes the main algorithm's logic simpler and easier to read.", "It is the only way to handle nested loops."], correct: ["It makes the main algorithm's logic simpler and easier to read."], type: "single", explanation: "By hiding the complexity of the inner loop inside a procedure, the main loop becomes a straightforward iteration that clearly expresses its high-level goal: check each card against the rest." }
        ];

        function buildQuiz() {
            quizContainer.innerHTML = '';
            quizData.forEach((q, index) => {
                const optionsHtml = q.options.map(option => `
                    <label class="quiz-option block p-3 border-2 border-slate-200 rounded-lg hover:bg-sky-50 cursor-pointer transition-colors">
                        <input type="radio" name="q${index}" value="${option}" class="mr-3">
                        ${option}
                    </label>
                `).join('');
                const codeHtml = q.code ? `<div class="my-4">${q.code}</div>` : '';
                const questionHtml = `
                    <div class="bg-white p-6 rounded-xl shadow-sm">
                        <p class="text-lg font-semibold mb-4">${index + 1}. ${q.question}</p>
                        ${codeHtml}
                        <div class="space-y-3" id="q${index}-options">${optionsHtml}</div>
                        <div id="feedback-${index}" class="feedback"></div>
                    </div>
                `;
                quizContainer.innerHTML += questionHtml;
            });
            quizData.forEach((q, index) => {
                document.getElementById(`q${index}-options`).addEventListener('change', () => handleAnswer(q, index));
            });
        }

        function handleAnswer(questionData, questionIndex) {
            const feedbackEl = document.getElementById(`feedback-${questionIndex}`);
            const inputs = document.querySelectorAll(`input[name="q${questionIndex}"]`);
            let selectedAnswers = [];
            inputs.forEach(input => {
                if (input.checked) selectedAnswers.push(input.value);
                input.disabled = true;
            });
            let isCorrect = selectedAnswers.length === 1 && selectedAnswers[0] === questionData.correct[0];
            
            inputs.forEach(input => {
                const label = input.parentElement;
                if (questionData.correct.includes(input.value)) {
                    label.classList.add('correct');
                } else if (input.checked) {
                    label.classList.add('incorrect');
                }
            });

            feedbackEl.innerHTML = `<strong>${isCorrect ? 'Correct!' : 'Not quite.'}</strong> ${questionData.explanation}`;
            feedbackEl.className = `feedback ${isCorrect ? 'correct' : 'incorrect'}`;
        }

        buildQuiz();
    </script>
</body>
</html>
