<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>L4.3: Importance of Binning</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* slate-50 */
        }
        .sidebar-link.active {
            background-color: #e0f2fe; /* sky-100 */
            color: #0c4a6e; /* sky-900 */
            font-weight: 600;
        }
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f5f9; /* slate-100 */
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1; /* slate-300 */
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8; /* slate-400 */
        }
        .quiz-option.correct {
            background-color: #dcfce7; /* green-100 */
            border-color: #22c55e; /* green-500 */
        }
        .quiz-option.incorrect {
            background-color: #fee2e2; /* red-100 */
            border-color: #ef4444; /* red-500 */
        }
        .feedback {
            display: none;
            padding: 0.75rem;
            margin-top: 0.75rem;
            border-radius: 0.5rem;
        }
        .feedback.correct {
            display: block;
            background-color: #f0fdf4; /* green-50 */
            color: #15803d; /* green-800 */
        }
        .feedback.incorrect {
            display: block;
            background-color: #fef2f2; /* red-50 */
            color: #b91c1c; /* red-800 */
        }
    </style>
</head>
<body class="text-slate-800">

    <!-- Mobile Header with Hamburger Menu -->
    <header class="bg-white/80 backdrop-blur-lg shadow-sm sticky top-0 z-40 lg:hidden flex items-center justify-between p-4">
        <h1 class="text-lg font-bold text-sky-800">Learning Guide</h1>
        <button id="hamburger-btn" class="p-2 rounded-md focus:outline-none focus:ring-2 focus:ring-sky-500">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
        </button>
    </header>

    <div class="flex">
        <!-- Sidebar Navigation -->
        <aside id="sidebar" class="bg-white w-64 fixed inset-y-0 left-0 transform -translate-x-full lg:translate-x-0 lg:sticky lg:top-0 h-screen transition-transform duration-300 ease-in-out z-50 shadow-lg lg:shadow-none border-r border-slate-200">
            <div class="p-6">
                <h2 class="text-xl font-bold text-sky-800 mb-6">L4.3: Why Binning Matters</h2>
                <nav>
                    <ul id="nav-links" class="space-y-2">
                        <li><a href="#intro" class="sidebar-link block px-4 py-2 rounded-md text-slate-600 hover:bg-sky-50 transition-colors">Introduction</a></li>
                        <li><a href="#explosion" class="sidebar-link block px-4 py-2 rounded-md text-slate-600 hover:bg-sky-50 transition-colors">The Combinatorial Explosion</a></li>
                        <li><a href="#rescue" class="sidebar-link block px-4 py-2 rounded-md text-slate-600 hover:bg-sky-50 transition-colors">Binning to the Rescue</a></li>
                        <li><a href="#interactive-sim" class="sidebar-link block px-4 py-2 rounded-md text-slate-600 hover:bg-sky-50 transition-colors">Interactive Calculator</a></li>
                        <li><a href="#quiz" class="sidebar-link block px-4 py-2 rounded-md text-slate-600 hover:bg-sky-50 transition-colors">Knowledge Check</a></li>
                    </ul>
                </nav>
            </aside>

        <!-- Main Content -->
        <main id="main-content" class="flex-1 p-6 md:p-10 lg:p-12 bg-slate-50 min-h-screen lg:h-screen lg:overflow-y-auto">
            <div class="max-w-4xl mx-auto">

                <!-- Introduction Section -->
                <section id="intro" class="mb-12">
                    <h2 class="text-3xl font-bold text-sky-900 mb-4 border-b-2 border-sky-200 pb-2">Counting the Cost üí∞</h2>
                    <p class="text-lg text-slate-700 mb-4">
                        We've established that the "binning" strategy feels smarter than the naive "compare-everyone-to-everyone" approach. But how much better is it really?
                    </p>
                    <p class="text-lg text-slate-700">
                        In computing, it's crucial to analyze and quantify the efficiency of our algorithms. This section dives into the mathematics behind pairwise comparisons to demonstrate just how dramatically binning reduces the number of operations, saving immense amounts of time, especially with large datasets.
                    </p>
                </section>

                <!-- Combinatorial Explosion Section -->
                <section id="explosion" class="mb-12">
                    <h2 class="text-3xl font-bold text-sky-900 mb-4 border-b-2 border-sky-200 pb-2">The Combinatorial Explosion</h2>
                    <p class="text-lg text-slate-700 mb-4">
                        When we compare every item in a set of size <strong>N</strong> with every other item, the number of unique pairs isn't just N. The first item is compared with N-1 others, the second with N-2 others, and so on.
                    </p>
                    <p class="text-lg text-slate-700">
                        This leads to a simple formula for the total number of comparisons:
                    </p>
                    <div class="bg-white p-6 rounded-xl shadow-md my-6 text-center">
                        <p class="text-2xl font-mono">Total Comparisons = N √ó (N - 1) / 2</p>
                    </div>
                    <p class="text-lg text-slate-700">
                        This number grows quadratically, which means it gets very large, very fast.
                    </p>
                     <div class="bg-amber-100 border-l-4 border-amber-500 text-amber-800 p-4 rounded-r-lg my-6">
                        <p class="font-semibold">Consider a dataset of 1 million items:</p>
                        <p>A naive pairwise comparison would require 1,000,000 √ó 999,999 / 2 ‚âà <strong>500 billion</strong> comparisons. If a computer can do 100 million (10<sup>8</sup>) comparisons per second, this would take nearly <strong>5000 seconds</strong>, or about 83 minutes!</p>
                    </div>
                </section>

                <!-- Binning to the Rescue Section -->
                <section id="rescue" class="mb-12">
                    <h2 class="text-3xl font-bold text-sky-900 mb-4 border-b-2 border-sky-200 pb-2">Binning to the Rescue</h2>
                    <p class="text-lg text-slate-700 mb-4">
                        Binning's power comes from breaking one huge problem into many tiny ones. Instead of one massive N¬≤/2 calculation, we do a series of smaller n¬≤/2 calculations, where 'n' is the number of items in each bin.
                    </p>
                    <div class="bg-sky-100 border-l-4 border-sky-500 text-sky-800 p-4 rounded-r-lg my-6">
                        <p class="font-semibold">Example:</p>
                        <p>Imagine 100 people. The naive approach requires 100 √ó 99 / 2 = <strong>4950</strong> comparisons.</p>
                        <p class="mt-2">Now, let's say we bin them by birth month, and each of the 10 bins has 10 people. For each bin, we need 10 √ó 9 / 2 = 45 comparisons. Since there are 10 such bins (we'll assume 12 for simplicity in the real world), the total is 10 √ó 45 = <strong>450</strong> comparisons. We've reduced the workload by over 90%!</p>
                    </div>
                     <p class="text-lg text-slate-700">
                        The cost is a single, fast iteration (N steps) to put everything into bins first. This initial sorting cost is tiny compared to the massive savings in comparison steps.
                    </p>
                </section>
                
                <!-- Interactive Simulator Section -->
                <section id="interactive-sim" class="mb-12">
                    <h2 class="text-3xl font-bold text-sky-900 mb-4 border-b-2 border-sky-200 pb-2">‚öôÔ∏è Comparison Calculator</h2>
                    <p class="text-lg text-slate-700 mb-6">
                        Use this calculator to see the impact of binning. Enter the total number of items. Then, distribute those items into the bins below and see how the total number of comparisons changes.
                    </p>
                    <div class="bg-white p-6 rounded-xl shadow-md">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <div>
                                <label for="total-items" class="block font-semibold mb-2">Total Number of Items (N)</label>
                                <input type="number" id="total-items" value="100" class="w-full p-2 border border-slate-300 rounded-md">
                                <div class="mt-4 bg-red-100 p-4 rounded-lg text-center">
                                    <p class="text-red-800">Naive Approach Comparisons:</p>
                                    <p id="naive-total" class="text-3xl font-bold text-red-700">4,950</p>
                                </div>
                            </div>
                            <div>
                                <h4 class="font-semibold mb-2">Distribute Items into Bins</h4>
                                <div id="bins-input-container" class="grid grid-cols-2 gap-2">
                                    <!-- Bin inputs will be generated here -->
                                </div>
                                <div class="mt-4 bg-green-100 p-4 rounded-lg text-center">
                                    <p class="text-green-800">Binning Approach Comparisons:</p>
                                    <p id="binned-total" class="text-3xl font-bold text-green-700">0</p>
                                </div>
                            </div>
                        </div>
                         <div id="warning-message" class="text-center text-amber-600 font-semibold mt-4 h-6"></div>
                    </div>
                </section>
                
                <!-- Quiz Section -->
                <section id="quiz">
                    <h2 class="text-3xl font-bold text-sky-900 mb-4 border-b-2 border-sky-200 pb-2">üß† Knowledge Check</h2>
                    <p class="text-lg text-slate-700 mb-8">
                        Test your understanding of the efficiency of binning.
                    </p>
                    <div id="quiz-container" class="space-y-8"></div>
                </section>

            </div>
        </main>
    </div>

    <script>
        // --- Sidebar and Scroll Logic ---
        const hamburgerBtn = document.getElementById('hamburger-btn');
        const sidebar = document.getElementById('sidebar');
        const mainContent = document.getElementById('main-content');
        const navLinks = document.getElementById('nav-links');

        hamburgerBtn.addEventListener('click', () => sidebar.classList.toggle('-translate-x-full'));
        navLinks.addEventListener('click', (e) => {
            if (e.target.tagName === 'A' && window.innerWidth < 1024) {
                sidebar.classList.add('-translate-x-full');
            }
        });
        
        const sections = document.querySelectorAll('section');
        const links = document.querySelectorAll('.sidebar-link');
        mainContent.addEventListener('scroll', () => {
            let current = '';
            sections.forEach(section => {
                if (mainContent.scrollTop >= section.offsetTop - 100) {
                    current = section.getAttribute('id');
                }
            });
            links.forEach(link => {
                link.classList.toggle('active', link.getAttribute('href') === `#${current}`);
            });
        });

        // --- Interactive Simulator Logic ---
        const totalItemsInput = document.getElementById('total-items');
        const naiveTotalEl = document.getElementById('naive-total');
        const binnedTotalEl = document.getElementById('binned-total');
        const binsInputContainer = document.getElementById('bins-input-container');
        const warningMessage = document.getElementById('warning-message');
        const NUM_BINS = 4;

        function calculateComparisons(n) {
            if (n < 2) return 0;
            return n * (n - 1) / 2;
        }

        function updateTotals() {
            const totalItems = parseInt(totalItemsInput.value) || 0;
            naiveTotalEl.textContent = calculateComparisons(totalItems).toLocaleString();
            
            let binnedItemsSum = 0;
            let binnedComparisons = 0;
            const binInputs = binsInputContainer.querySelectorAll('input');
            
            binInputs.forEach(input => {
                const binCount = parseInt(input.value) || 0;
                binnedItemsSum += binCount;
                binnedComparisons += calculateComparisons(binCount);
            });
            
            binnedTotalEl.textContent = binnedComparisons.toLocaleString();

            if (binnedItemsSum > totalItems) {
                warningMessage.textContent = "Warning: Sum of items in bins is greater than total items!";
            } else {
                warningMessage.textContent = "";
            }
        }

        function setupSimulator() {
            binsInputContainer.innerHTML = '';
            for (let i = 1; i <= NUM_BINS; i++) {
                const div = document.createElement('div');
                div.innerHTML = `<label for="bin-${i}" class="block text-sm font-medium text-gray-700">Bin ${i}</label>
                                 <input type="number" id="bin-${i}" value="0" class="bin-input w-full p-2 border border-slate-300 rounded-md">`;
                binsInputContainer.appendChild(div);
            }
            totalItemsInput.addEventListener('input', updateTotals);
            binsInputContainer.addEventListener('input', updateTotals);
            updateTotals();
        }

        setupSimulator();
        
        // --- Quiz Logic ---
        const quizContainer = document.getElementById('quiz-container');
        const quizData = [
            { question: "We have n cards in a pile. We compare each card with every other card exactly once. What is the total number of comparisons?", options: ["n¬≤", "n¬≤/2", "n(n-1)", "n(n-1)/2"], correct: ["n(n-1)/2"], type: "single", explanation: "This is the standard formula for combinations of 2 items from a set of n, which represents the number of unique pairs." },
            { question: "If we connect each of 7 elements with every other element by lines, how many lines would we have to draw?", options: [], correct: ["21"], type: "custom", explanation: "Using the formula n(n-1)/2, we get 7 * (7-1) / 2 = 7 * 6 / 2 = 42 / 2 = 21 lines." },
            { question: "A computer can do 10‚Å∏ comparisons/sec. How long will it take to do pairwise comparisons of one million (10‚Å∂) elements?", options: ["Nearly 5000 seconds", "Nearly 1000 seconds", "Less than 1 second", "Nearly 10 seconds"], correct: ["Nearly 5000 seconds"], type: "single", explanation: "Comparisons = (10‚Å∂ * (10‚Å∂-1))/2 ‚âà 5x10¬π¬π. Time = (5x10¬π¬π) / 10‚Å∏ = 5x10¬≥ = 5000 seconds." },
            { question: "What is the primary trade-off when using the binning method?", options: ["It uses more memory but is faster.", "It is slower but uses less memory.", "It is more complex to write but has no other trade-offs.", "It is less accurate than the naive method."], correct: ["It uses more memory but is faster."], type: "single", explanation: "Binning requires extra memory to store the bins and the items within them, but this cost is usually far outweighed by the massive reduction in computation time (fewer comparisons)." },
            { question: "Binning is most effective when...", options: ["All items fall into a single bin.", "The data is evenly distributed among many bins.", "The number of bins is greater than the number of items.", "The data is already sorted."], correct: ["The data is evenly distributed among many bins."], type: "single", explanation: "The greatest reduction in comparisons occurs when the large N is broken down into many small groups, rather than one or two large groups." }
        ];

        function buildQuiz() {
            quizContainer.innerHTML = '';
            quizData.forEach((q, index) => {
                let optionsHtml = '';
                 if(q.type === 'custom') {
                    optionsHtml = `<input type="text" name="q${index}" class="mt-1 block w-full px-3 py-2 bg-white border border-slate-300 rounded-md text-sm shadow-sm placeholder-slate-400 focus:outline-none focus:border-sky-500 focus:ring-1 focus:ring-sky-500">`;
                } else {
                    optionsHtml = q.options.map(option => `
                        <label class="quiz-option block p-3 border-2 border-slate-200 rounded-lg hover:bg-sky-50 cursor-pointer transition-colors">
                            <input type="radio" name="q${index}" value="${option}" class="mr-3">
                            ${option}
                        </label>
                    `).join('');
                }
                const questionHtml = `
                    <div class="bg-white p-6 rounded-xl shadow-sm">
                        <p class="text-lg font-semibold mb-4">${index + 1}. ${q.question}</p>
                        <div class="space-y-3" id="q${index}-options">${optionsHtml}</div>
                        <div id="feedback-${index}" class="feedback"></div>
                    </div>
                `;
                quizContainer.innerHTML += questionHtml;
            });
            quizData.forEach((q, index) => {
                document.getElementById(`q${index}-options`).addEventListener('change', () => handleAnswer(q, index));
            });
        }

        function handleAnswer(questionData, questionIndex) {
            const feedbackEl = document.getElementById(`feedback-${questionIndex}`);
            const inputs = document.querySelectorAll(`[name="q${questionIndex}"]`);
            let selectedAnswers = [];
            inputs.forEach(input => {
                if (input.type === 'text' && input.value !== '') {
                    selectedAnswers.push(input.value);
                } else if (input.checked) {
                    selectedAnswers.push(input.value);
                }
                input.disabled = true;
            });
            let isCorrect = selectedAnswers.length === 1 && selectedAnswers[0] === questionData.correct[0];
            
            inputs.forEach(input => {
                const label = input.parentElement;
                 if (input.type !== 'text' && questionData.correct.includes(input.value)) {
                    label.classList.add('correct');
                } else if (input.checked || (input.type === 'text' && input.value !== '')) {
                     if(!isCorrect) label.classList.add('incorrect');
                     else label.classList.add('correct');
                }
            });

            feedbackEl.innerHTML = `<strong>${isCorrect ? 'Correct!' : 'Not quite.'}</strong> ${questionData.explanation}`;
            feedbackEl.className = `feedback ${isCorrect ? 'correct' : 'incorrect'}`;
        }

        buildQuiz();
    </script>
</body>
</html>
