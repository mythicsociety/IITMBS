<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Learning Guide: Flowcharts with Filtering</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #4f46e5;
            --primary-hover: #4338ca;
            --secondary-color: #10b981;
            --incorrect-color: #ef4444;
            --correct-color: #22c55e;
            --sidebar-bg: #1f2937;
            --main-bg: #f9fafb;
            --text-color: #111827;
        }
        body {
            font-family: 'Inter', sans-serif;
            color: var(--text-color);
            background-color: var(--main-bg);
        }
        #sidebar {
            transition: transform 0.3s ease-in-out;
        }
        .sidebar-link {
            transition: all 0.2s ease-in-out;
            border-left: 3px solid transparent;
        }
        .sidebar-link.active, .sidebar-link:hover {
            background-color: #374151;
            color: white;
            border-left-color: var(--primary-color);
        }
        @media (max-width: 1024px) {
            #sidebar.hidden-mobile {
                transform: translateX(-100%);
            }
        }
        h2 {
            font-size: 1.875rem;
            font-weight: 700;
            color: var(--primary-color);
            border-bottom: 2px solid #e5e7eb;
            padding-bottom: 0.5rem;
            margin-bottom: 1.5rem;
        }
        h3 {
            font-size: 1.5rem;
            font-weight: 600;
            color: #374151;
            margin-top: 2rem;
            margin-bottom: 1rem;
        }
        .card {
            background-color: white;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        .quiz-question {
            border: 1px solid #e5e7eb;
        }
        .quiz-question.correct {
            border-left: 5px solid var(--correct-color);
        }
        .quiz-question.incorrect {
            border-left: 5px solid var(--incorrect-color);
        }
        .quiz-feedback {
            display: none;
            margin-top: 1rem;
            padding: 0.75rem;
            border-radius: 0.375rem;
        }
        .quiz-feedback.correct {
            background-color: #dcfce7;
            color: #166534;
        }
        .quiz-feedback.incorrect {
            background-color: #fee2e2;
            color: #991b1b;
        }
        /* Interactive Flowchart Builder */
        .draggable {
            cursor: grab;
            transition: transform 0.2s;
        }
        .draggable:active {
            cursor: grabbing;
            transform: scale(1.1);
            z-index: 10;
        }
        #drop-zone {
            border: 3px dashed #cbd5e1;
            transition: background-color 0.2s, border-color 0.2s;
            min-height: 80px;
        }
        #drop-zone.over {
            background-color: #e0e7ff;
            border-color: var(--primary-color);
        }
        #drop-zone.correct {
            border-style: solid;
            border-color: var(--correct-color);
            background-color: #dcfce7;
        }
        #drop-zone.incorrect {
            border-style: solid;
            border-color: var(--incorrect-color);
            background-color: #fee2e2;
        }
    </style>
</head>
<body class="bg-gray-50">

    <button id="menu-btn" class="lg:hidden fixed top-4 left-4 z-30 bg-white p-2 rounded-md shadow-lg">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" /></svg>
    </button>

    <aside id="sidebar" class="bg-gray-800 text-gray-300 w-64 min-h-screen fixed top-0 left-0 z-20 transform -translate-x-full lg:translate-x-0 transition-transform duration-300 ease-in-out">
        <div class="p-4">
            <h1 class="text-white text-2xl font-bold">CT Guide</h1>
            <p class="text-sm text-gray-400">Flowcharts with Filtering</p>
        </div>
        <nav id="nav-links" class="mt-4 flex flex-col">
            <a href="#intro" class="sidebar-link py-2 px-4">Introduction</a>
            <a href="#modifying" class="sidebar-link py-2 px-4">1. Modifying a Flowchart</a>
            <a href="#interactive-build" class="sidebar-link py-2 px-4">2. Interactive Flowchart Builder</a>
            <a href="#final-flowchart" class="sidebar-link py-2 px-4">3. The Complete Flowchart</a>
            <a href="#quiz" class="sidebar-link py-2 px-4">4. Knowledge Check</a>
        </nav>
    </aside>

    <main id="main-content" class="lg:ml-64 p-4 md:p-8">
        
        <section id="intro" class="card">
            <h2>Introduction: Adding Intelligence to Flowcharts</h2>
            <p class="mb-4 text-lg">We've seen how flowcharts can map out a simple iteration, like summing up the marks for all students. But what if we want our process to be more selective? How do we tell our flowchart to only sum the marks for the girls, or only for students from a certain city?</p>
            <p>This is where we introduce a <strong>filter</strong> into our flowchart. By adding a simple decision point inside our loop, we can make our algorithm much smarter and more powerful, allowing it to handle more complex and specific tasks.</p>
        </section>

        <section id="modifying" class="card">
            <h2>1. Modifying a Flowchart for Filtering</h2>
            <p class="mb-4">Let's start with our basic flowchart for summing the math marks of all students.</p>
            <div class="bg-white p-4 rounded-lg shadow-inner overflow-x-auto">
                <svg width="100%" viewBox="0 0 400 520" preserveAspectRatio="xMidYMid meet" aria-labelledby="summing-flowchart-title" role="img">
                    <title id="summing-flowchart-title">Basic flowchart for summing math marks for all students.</title>
                    <defs><marker id="arrowhead-sum" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto"><polygon points="0 0, 10 3.5, 0 7" fill="#374151" /></marker></defs>
                    <style>.flow-box-sum { fill: #60a5fa; stroke: #1d4ed8; stroke-width: 1.5; } .flow-decision-sum { fill: #93c5fd; stroke: #1d4ed8; stroke-width: 1.5; } .flow-terminal-sum { fill: #3b82f6; stroke: #1e40af; stroke-width: 1.5; } .flow-text-sum { font-family: 'Inter', sans-serif; font-size: 14px; fill: #1f2937; text-anchor: middle; } .flow-line-sum { stroke: #374151; stroke-width: 2; marker-end: url(#arrowhead-sum); fill: none; } .flow-label-sum { font-family: 'Inter', sans-serif; font-size: 12px; fill: #4b5563; }</style>
                    <rect x="150" y="10" width="100" height="40" rx="20" class="flow-terminal-sum" /><text x="200" y="35" class="flow-text-sum" fill="white">Start</text>
                    <path class="flow-line-sum" d="M 200 50 L 200 80" />
                    <rect x="140" y="80" width="120" height="40" rx="5" class="flow-box-sum" /><text x="200" y="105" class="flow-text-sum">Sum = 0</text>
                    <path class="flow-line-sum" d="M 200 120 L 200 150" />
                    <polygon points="200,150 280,190 200,230 120,190" class="flow-decision-sum" /><text x="200" y="185" class="flow-text-sum">More cards</text><text x="200" y="205" class="flow-text-sum">in Pile 1?</text>
                    <path class="flow-line-sum" d="M 280 190 L 320 190" /><text x="295" y="185" class="flow-label-sum">No (False)</text>
                    <rect x="320" y="170" width="70" height="40" rx="20" class="flow-terminal-sum" /><text x="355" y="195" class="flow-text-sum" fill="white">End</text>
                    <path class="flow-line-sum" d="M 200 230 L 200 260" /><text x="210" y="245" class="flow-label-sum">Yes (True)</text>
                    <rect x="115" y="260" width="170" height="40" rx="5" class="flow-box-sum" /><text x="200" y="285" class="flow-text-sum">Pick a card X from Pile 1</text>
                    <path class="flow-line-sum" d="M 200 300 L 200 330" />
                    <rect x="140" y="330" width="120" height="40" rx="5" class="flow-box-sum" /><text x="200" y="355" class="flow-text-sum">Move X to Pile 2</text>
                    <path class="flow-line-sum" d="M 200 370 L 200 400" />
                    <rect x="90" y="400" width="220" height="40" rx="5" class="flow-box-sum" /><text x="200" y="425" class="flow-text-sum">Add CardX's Maths score to Sum</text>
                    <path class="flow-line-sum" d="M 200 440 L 200 460 L 60 460 L 60 190 L 120 190" />
                </svg>
            </div>
            
            <p class="mb-4 mt-6">Our goal is to change this to compute the sum of marks for <strong>only the girls</strong>. To do this, we need to insert a check. Here’s the thinking process:</p>
            <ol class="list-decimal list-inside space-y-3">
                <li><strong>What do we need to check?</strong> We need to check the gender of the student on the card. The question is "Is the student a girl?".</li>
                <li><strong>What symbol do we use for a check?</strong> All questions or conditions in a flowchart are represented by a <strong>Decision</strong> diamond.</li>
                <li><strong>Where does the check go?</strong> This is the most important part. We can't check the gender before we've picked a card, and we must check it *before* we add the marks to our sum. Therefore, the correct place to insert our decision is right after we've moved the card to Pile 2, but before we add the score to the sum.</li>
            </ol>
             <div class="bg-indigo-50 border-l-4 border-indigo-500 text-indigo-700 p-4 rounded-md mt-6" role="alert">
                <p class="font-bold">Key Logic</p>
                <p>A filter condition inside a loop is placed after an item is selected but before the main action is performed on that item.</p>
            </div>
        </section>

        <section id="interactive-build" class="card">
            <h2>2. Interactive Flowchart Builder</h2>
            <p class="mb-6">Now it's your turn to modify the flowchart. The flowchart below has a missing step. Drag the correct symbol from the bank on the left and drop it into the empty slot to complete the logic for summing only the girls' marks.</p>
            <div class="bg-white p-6 rounded-lg shadow-inner border">
                <div class="flex flex-col md:flex-row gap-8">
                    <!-- Draggable Symbols -->
                    <div class="flex flex-col gap-4 p-4 bg-gray-100 rounded-lg">
                        <p class="font-bold text-center">Symbol Bank</p>
                        <div class="draggable" draggable="true" data-symbol="decision">
                             <svg width="120" height="70" viewBox="0 0 120 70"><polygon points="60,5 115,35 60,65 5,35" fill="#93c5fd" stroke="#1d4ed8" stroke-width="1.5" /><text x="60" y="40" font-size="12" text-anchor="middle">Is X a girl?</text></svg>
                        </div>
                        <div class="draggable" draggable="true" data-symbol="process">
                            <svg width="120" height="70" viewBox="0 0 120 70"><rect x="5" y="15" width="110" height="40" rx="5" fill="#60a5fa" stroke="#1d4ed8" stroke-width="1.5" /><text x="60" y="40" font-size="12" text-anchor="middle">Add to Sum</text></svg>
                        </div>
                         <div class="draggable" draggable="true" data-symbol="terminal">
                            <svg width="120" height="70" viewBox="0 0 120 70"><rect x="5" y="15" width="110" height="40" rx="20" fill="#3b82f6" stroke="#1e40af" stroke-width="1.5" /><text x="60" y="40" font-size="12" fill="white" text-anchor="middle">End</text></svg>
                        </div>
                    </div>
                    <!-- Flowchart with drop zone -->
                    <div class="flex-grow">
                        <p class="text-center font-semibold mb-2">Flowchart</p>
                        <div class="text-center">
                            <svg width="150" viewBox="0 0 150 120">
                                <rect x="25" y="5" width="100" height="40" rx="5" fill="#60a5fa" stroke="#1d4ed8" stroke-width="1.5" />
                                <text x="75" y="30" font-size="12" text-anchor="middle">Move X to Pile 2</text>
                                <line x1="75" y1="45" x2="75" y2="75" stroke="#374151" stroke-width="2" marker-end="url(#arrow-build)"/>
                            </svg>
                        </div>
                        <div id="drop-zone" class="mx-auto w-48 p-4 rounded-lg flex items-center justify-center"></div>
                        <div class="text-center">
                             <svg width="150" viewBox="0 0 150 120">
                                <defs><marker id="arrow-build" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="6" markerHeight="6" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" fill="#374151" /></marker></defs>
                                <line x1="75" y1="0" x2="75" y2="30" stroke="#374151" stroke-width="2" marker-end="url(#arrow-build)"/>
                                <rect x="10" y="30" width="130" height="40" rx="5" fill="#60a5fa" stroke="#1d4ed8" stroke-width="1.5" />
                                <text x="75" y="55" font-size="12" text-anchor="middle">Add score to Sum</text>
                             </svg>
                        </div>
                    </div>
                </div>
                <div id="builder-feedback" class="text-center mt-4 h-6 font-semibold"></div>
            </div>
        </section>

        <section id="final-flowchart" class="card">
            <h2>3. The Complete Flowchart with Filtering</h2>
            <p class="mb-4">Here is the final, correct flowchart. Notice how the "No" path from our new decision diamond bypasses the "Add to Sum" step and goes straight back to the start of the loop. This ensures that if the card does not belong to a girl, its marks are simply ignored.</p>
             <div class="bg-white p-4 rounded-lg shadow-inner overflow-x-auto">
                <svg width="100%" viewBox="0 0 450 600" preserveAspectRatio="xMidYMid meet" aria-labelledby="filtering-flowchart-title" role="img">
                    <title id="filtering-flowchart-title">Flowchart showing iteration with a filtering condition.</title>
                    <defs><marker id="arrowhead2" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto"><polygon points="0 0, 10 3.5, 0 7" fill="#374151" /></marker></defs>
                    <style>.flow-box { fill: #60a5fa; stroke: #1d4ed8; stroke-width: 1.5; } .flow-decision { fill: #93c5fd; stroke: #1d4ed8; stroke-width: 1.5; } .flow-terminal { fill: #3b82f6; stroke: #1e40af; stroke-width: 1.5; } .flow-text { font-family: 'Inter', sans-serif; font-size: 12px; fill: #1f2937; text-anchor: middle; } .flow-line { stroke: #374151; stroke-width: 2; marker-end: url(#arrowhead2); fill: none;} .flow-label { font-family: 'Inter', sans-serif; font-size: 11px; fill: #4b5563; }</style>
                    <rect x="175" y="10" width="100" height="40" rx="20" class="flow-terminal" /><text x="225" y="35" class="flow-text" fill="white">Start</text>
                    <path class="flow-line" d="M 225 50 L 225 80" />
                    <rect x="165" y="80" width="120" height="40" rx="5" class="flow-box" /><text x="225" y="105" class="flow-text">Sum = 0</text>
                    <path class="flow-line" d="M 225 120 L 225 150" />
                    <polygon points="225,150 305,190 225,230 145,190" class="flow-decision" /><text x="225" y="185" class="flow-text">More cards</text><text x="225" y="205" class="flow-text">in Pile 1?</text>
                    <path class="flow-line" d="M 305 190 L 345 190" /><text x="320" y="185" class="flow-label">No</text>
                    <rect x="345" y="170" width="70" height="40" rx="20" class="flow-terminal" /><text x="380" y="195" class="flow-text" fill="white">End</text>
                    <path class="flow-line" d="M 225 230 L 225 260" /><text x="235" y="245" class="flow-label">Yes</text>
                    <rect x="150" y="260" width="150" height="40" rx="5" class="flow-box" /><text x="225" y="285" class="flow-text">Pick & Move Card X</text>
                    <path class="flow-line" d="M 225 300 L 225 330" />
                    <polygon points="225,330 315,380 225,430 135,380" class="flow-decision" /><text x="225" y="385" class="flow-text">Is X a girl?</text>
                    <path class="flow-line" d="M 225 430 L 225 460" /><text x="235" y="445" class="flow-label">Yes (True)</text>
                    <rect x="140" y="460" width="170" height="40" rx="5" class="flow-box" /><text x="225" y="485" class="flow-text">Add CardX's Maths score to Sum</text>
                    <path class="flow-line" d="M 225 500 L 225 530 L 85 530 L 85 200 L 145 200" />
                    <path class="flow-line" d="M 315 380 L 385 380 L 385 200 L 305 200" /><text x="345" y="375" class="flow-label">No (False)</text>
                </svg>
            </div>
        </section>

        <section id="quiz" class="card">
            <h2>4. Knowledge Check</h2>
            <p class="mb-6">Test your understanding of modifying flowcharts with filters.</p>
            <div id="quiz-container" class="space-y-6"></div>
        </section>

    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- Sidebar Logic ---
            const sidebar = document.getElementById('sidebar');
            const menuBtn = document.getElementById('menu-btn');
            const navLinks = document.querySelectorAll('.sidebar-link');
            const sections = document.querySelectorAll('main section');
            menuBtn.addEventListener('click', () => sidebar.classList.toggle('-translate-x-full'));
            navLinks.forEach(link => {
                link.addEventListener('click', () => { if (window.innerWidth < 1024) sidebar.classList.add('-translate-x-full'); });
            });
            window.addEventListener('scroll', () => {
                let current = '';
                sections.forEach(section => { if (pageYOffset >= section.offsetTop - 100) current = section.getAttribute('id'); });
                navLinks.forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('href').substring(1) === current) link.classList.add('active');
                });
            });

            // --- Interactive Flowchart Builder Logic ---
            const draggables = document.querySelectorAll('.draggable');
            const dropZone = document.getElementById('drop-zone');
            const builderFeedback = document.getElementById('builder-feedback');
            let draggedItem = null;

            draggables.forEach(draggable => {
                draggable.addEventListener('dragstart', (e) => {
                    draggedItem = e.target.closest('.draggable');
                    setTimeout(() => e.target.style.opacity = '0.5', 0);
                });
                draggable.addEventListener('dragend', (e) => {
                    e.target.style.opacity = '1';
                    draggedItem = null;
                });
            });

            dropZone.addEventListener('dragover', e => {
                e.preventDefault();
                dropZone.classList.add('over');
            });
            dropZone.addEventListener('dragleave', () => dropZone.classList.remove('over'));
            dropZone.addEventListener('drop', e => {
                e.preventDefault();
                dropZone.classList.remove('over');
                if (draggedItem) {
                    const symbolType = draggedItem.dataset.symbol;
                    if (symbolType === 'decision') {
                        dropZone.innerHTML = '';
                        dropZone.appendChild(draggedItem);
                        dropZone.classList.add('correct');
                        builderFeedback.textContent = 'Correct! A decision symbol is needed here.';
                        builderFeedback.style.color = 'var(--correct-color)';
                    } else {
                        dropZone.classList.add('incorrect');
                        builderFeedback.textContent = 'Not quite. What kind of symbol asks a question?';
                        builderFeedback.style.color = 'var(--incorrect-color)';
                        setTimeout(() => {
                            dropZone.classList.remove('incorrect');
                            builderFeedback.textContent = '';
                        }, 2000);
                    }
                }
            });

            // --- Quiz Logic ---
            const quizData = [
                {
                    question: "What type of flowchart symbol should be inserted?",
                    type: 'single',
                    options: ["Decision", "Terminal", "Flowline", "Activity"],
                    correctAnswer: "Decision",
                    explanation: "A Decision symbol (diamond) is needed because we have to ask a question ('Is the student a girl?') to decide whether to perform the sum action."
                },
                {
                    question: "Where should this symbol be inserted?",
                    type: 'single',
                    options: [
                        "Between 'More cards in Pile 1?' and 'Pick a card X from Pile 1'",
                        "Between 'Sum = 0' and 'More cards in Pile 1?'",
                        "Between 'Move X to Pile 2' and 'Add Card X’s maths score to Sum'"
                    ],
                    correctAnswer: "Between 'Move X to Pile 2' and 'Add Card X’s maths score to Sum'",
                    explanation: "The check must happen after a card is picked (so we have something to check) but before the sum action is performed (so we can decide whether to do it or not)."
                },
                {
                    question: "What should be the text inside this symbol?",
                    type: 'single',
                    options: ["Is X a boy?", "Is X a girl?"],
                    correctAnswer: "Is X a girl?",
                    explanation: "The condition must match the goal. Since we want to sum the marks for girls, the question we need to ask is 'Is X a girl?'."
                },
                {
                    question: "In the modified flowchart, what happens if the answer to the 'Is X a girl?' condition is 'No'?",
                    type: 'single',
                    options: [
                        "The program ends immediately.",
                        "The card's marks are added to a different sum.",
                        "The 'Add to Sum' step is skipped, and the loop continues to the next card."
                    ],
                    correctAnswer: "The 'Add to Sum' step is skipped, and the loop continues to the next card.",
                    explanation: "The 'No' path should bypass the action and return to the beginning of the loop to process the next item, effectively ignoring the current card."
                },
                {
                    question: "If you wanted to sum the marks of ONLY boys, what would change in the flowchart?",
                    type: 'single',
                    options: [
                        "The 'Sum = 0' box would be removed.",
                        "The text in the decision diamond would change to 'Is X a boy?'.",
                        "The shape of the decision symbol would change to a rectangle.",
                        "Nothing would need to change."
                    ],
                    correctAnswer: "The text in the decision diamond would change to 'Is X a boy?'.",
                    explanation: "The overall structure of the flowchart remains the same. The only change required is to modify the filter condition inside the decision diamond to match the new requirement."
                },
                {
                    question: "True or False: Adding a filter always makes a flowchart more complex by adding at least one new Decision symbol and one new Flowline.",
                    type: 'true-false',
                    options: ["True", "False"],
                    correctAnswer: "True",
                    explanation: "True. To add a filter, you must add a Decision symbol to ask the filtering question, and you will need at least one new flowline to represent the path taken if the condition is not met."
                },
                {
                    question: "Which of the following tasks would require adding a filtering step (a Decision diamond) to the basic summing flowchart? (Select all that apply)",
                    type: 'multiple',
                    options: [
                        "Summing the marks of all students.",
                        "Summing the marks of students from 'Chennai'.",
                        "Summing the marks of students whose total score is above 250.",
                        "Finding the total number of students."
                    ],
                    correctAnswer: ["Summing the marks of students from 'Chennai'.", "Summing the marks of students whose total score is above 250."],
                    explanation: "Summing all students or counting all students does not require a filter. Summing based on a city or a score threshold are selective tasks that require a filtering condition."
                },
                {
                    question: "In a filtered sum flowchart, both the 'Yes' and 'No' paths from the filter condition must eventually loop back to where?",
                    type: 'single',
                    options: [
                        "The 'End' terminal",
                        "The 'Start' terminal",
                        "The 'More cards in Pile 1?' decision",
                        "The 'Add to Sum' activity"
                    ],
                    correctAnswer: "The 'More cards in Pile 1?' decision",
                    explanation: "Regardless of whether the item was processed or skipped, the loop must continue to the next item. This is done by returning to the main loop condition that checks if there are any items left."
                },
                {
                    question: "What is the primary advantage of adding a filter inside the iteration loop, rather than filtering all the data into a new pile first?",
                    type: 'single',
                    options: [
                        "It uses fewer flowchart symbols.",
                        "It is more efficient because it only requires one pass through the data.",
                        "It makes the flowchart easier to read.",
                        "It allows for more complex calculations."
                    ],
                    correctAnswer: "It is more efficient because it only requires one pass through the data.",
                    explanation: "Processing the data in a single pass (one iteration) is more computationally efficient than iterating once to filter and a second time to perform the calculation."
                }
            ];

            const quizContainer = document.getElementById('quiz-container');
            quizData.forEach((q, index) => {
                const questionElem = document.createElement('div');
                questionElem.className = 'quiz-question card p-6';
                let optionsHtml = '';
                if(q.type === 'single' || q.type === 'true-false') {
                    optionsHtml = q.options.map(opt => `<label class="block mb-2"><input type="radio" name="q${index}" value="${opt}" class="mr-2">${opt}</label>`).join('');
                } else if (q.type === 'multiple') {
                    optionsHtml = q.options.map(opt => `<label class="block mb-2"><input type="checkbox" name="q${index}" value="${opt}" class="mr-2">${opt}</label>`).join('');
                }
                questionElem.innerHTML = `<p class="font-semibold mb-4">${index + 1}. ${q.question}</p><div class="options-container">${optionsHtml}</div><button class="submit-btn mt-4 px-4 py-2 bg-indigo-500 text-white rounded hover:bg-indigo-600">Submit</button><div class="quiz-feedback"><p class="font-bold feedback-title"></p><p class="feedback-text">${q.explanation}</p></div>`;
                quizContainer.appendChild(questionElem);
                questionElem.querySelector('.submit-btn').addEventListener('click', e => {
                    e.target.disabled = true;
                    const feedbackElem = questionElem.querySelector('.quiz-feedback');
                    const feedbackTitle = questionElem.querySelector('.feedback-title');
                    let isCorrect = false;
                    if (q.type === 'single' || q.type === 'true-false') {
                        const selected = questionElem.querySelector(`input[name="q${index}"]:checked`);
                        if (selected && selected.value === q.correctAnswer) isCorrect = true;
                    } else if (q.type === 'multiple') {
                        const selected = Array.from(questionElem.querySelectorAll(`input[name="q${index}"]:checked`)).map(el => el.value);
                        if (selected.length === q.correctAnswer.length && selected.every(val => q.correctAnswer.includes(val))) isCorrect = true;
                    }
                    if (isCorrect) {
                        questionElem.classList.add('correct');
                        feedbackElem.classList.add('correct');
                        feedbackTitle.textContent = 'Correct!';
                    } else {
                        questionElem.classList.add('incorrect');
                        feedbackElem.classList.add('incorrect');
                        feedbackTitle.textContent = 'Incorrect';
                    }
                    feedbackElem.style.display = 'block';
                    questionElem.querySelectorAll('input').forEach(input => input.disabled = true);
                });
            });
        });
    </script>
</body>
</html>
